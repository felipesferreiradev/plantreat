<%= render "shared/navbar" %>

<div class="container plant_detail_container" data-controller="display-input">

  <%= image_tag "plantreat_logo.png", :class => "plant_show_logo", style: "height:60px; width:60px"%>
  <h2 class="mb-5 p-2"><%=@plant.name %></h2>

  <%# show points %>

  <div id="carouselExampleControls" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <% if @log.photos.attached? %>
        <% @log.photos.each do | photo | %>
          <div class="carousel-item active">
          	<%= cl_image_tag photo.key, class: "w-100 d-block rounded", style: "object-fit: cover; height: 450px" %>
          </div>
        <% end %>
      <% else %>
        <div class="carousel-item active">
          <img src="<%=@plant.plants_images%> " class="d-block w-100 rounded" style="object-fit: cover; height: 450px">
        </div>
        <div class="carousel-item">
          <img src="<%=@plant.plant_image_2%>" class="d-block w-100 rounded" style="object-fit: cover; height: 450px">
        </div>
        <div class="carousel-item">
          <img src="<%=@plant.plant_image_3%>" class="d-block w-100 rounded" style="object-fit: cover; height: 450px">
        </div>
      <% end %>
    </div>

    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

  <%#sick button  %>

  <div class = "d-flex justify-content-center mt-2">
    <%= link_to 'My plant looks sick', treatment_path(@plant), class:"btn mt-1", id:"btn-plant-sick"%>
  </div>

  <%#show treatment options  %>
  <div class="d-flex justify-content-center">
    <div class="row d-flex gap-3">
      <div class="col d-flex flex-column align-items-center">
        <% if @log.watered%>
        <%= link_to remove_water_log_path(@log) do %>
          <img class="p-2" src="https://img.icons8.com/color/344/water.png" style="height:50px; object-fit: cover; background-color: #E9FFE3; border-radius: 10px">
          <p class="plant_detail_label_content mt-1">Water</p>
        <% end %>
        <% else %>
        <%= link_to add_water_log_path(@log) do %>
            <img class="p-2" src="https://img.icons8.com/color/344/water.png" style="height:50px; object-fit: cover; background-color: #F5F7F4; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Water</p>
        <% end %>
        <% end %>
      </div>

      <div class="col d-flex flex-column align-items-center">
        <% if @log.light%>
          <%= link_to remove_sun_log_path(@log) do %>
            <img class="p-2" src="https://cdn-icons-png.flaticon.com/512/869/869869.png" style="height:50px; object-fit: cover; background-color: #E9FFE3; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Sun</p>
          <% end %>
        <% else %>
          <%= link_to add_sun_log_path(@log) do %>
            <img class="p-2" src="https://cdn-icons-png.flaticon.com/512/869/869869.png" style="height:50px; object-fit: cover; background-color: #F5F7F4; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Sun</p>
          <% end %>
        <% end %>
      </div>

      <div class="col d-flex flex-column align-items-center">
        <% if @log.soil_changed%>
          <%= link_to remove_soil_log_path(@log) do %>
            <img class="p-2" src="https://img.icons8.com/external-icongeek26-flat-icongeek26/344/external-Fertile-Soil-gardening-icongeek26-flat-icongeek26.png" style="height:50px; object-fit: cover; background-color: #E9FFE3; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Soil</p>
          <% end %>
        <% else %>
          <%= link_to add_soil_log_path(@log) do %>
            <img class="p-2" src="https://img.icons8.com/external-icongeek26-flat-icongeek26/344/external-Fertile-Soil-gardening-icongeek26-flat-icongeek26.png" style="height:50px; object-fit: cover; background-color: #F5F7F4; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Soil</p>
          <% end %>
        <% end %>
      </div>

      <div class="col d-flex flex-column align-items-center">
        <% if @log.fed%>
          <%= link_to remove_food_log_path(@log) do %>
            <img class="p-2" src="https://img.icons8.com/color/344/paper-bag-with-seeds.png" style="height:50px; object-fit: cover; background-color: #E9FFE3; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Food</p>
          <% end %>
        <% else %>
          <%= link_to add_food_log_path(@log) do %>
            <img class="p-2" src="https://img.icons8.com/color/344/paper-bag-with-seeds.png" style="height:50px; object-fit: cover; background-color: #F5F7F4; border-radius: 10px">
            <p class="plant_detail_label_content mt-1">Food</p>
          <% end %>
        <% end %>
      </div>

      <div class="col d-flex flex-column align-items-center" >
        <% if @log.photos.attached?%>
          <img class="p-2" src="https://img.icons8.com/fluency/344/add-camera.png" style="height:50px; object-fit: cover; background-color: #E9FFE3; border-radius: 10px; cursor: pointer;" data-action="click->display-input#displayForm">
          <p class="plant_detail_label_content mt-1">Photo</p>
        <% else %>
          <img class="p-2" src="https://img.icons8.com/fluency/344/add-camera.png" style="height:50px; object-fit: cover; background-color: #F5F7F4; border-radius: 10px; cursor: pointer;" data-action="click->display-input#displayForm">
          <p class="plant_detail_label_content mt-1">Photo</p>
        <% end %>
      </div>
    </div>
  </div>

  <%# add new picture button %>

  <div class="d-flex justify-content-center mt-3 ms-5 mb-5 d-none" data-display-input-target="form">
    <%= simple_form_for @log do |f| %>
      <%= f.input :photos, as: :file, direct_upload: true, :class => "add_pic", input_html: { multiple: true }%>
      <%= f.button :submit, "Upload" %>
    <% end %>
  </div>



  <%#history %>
  <div>
      <h3 class="mt-3" style="color: #725B39;">Logs</h3>
      <h3 class="score_title">Score: <%= current_user.points %> points</h3>
  </div>

  <%#all history cards%>

  <div class="all_history_cards" >
    <% @user_histories.each do |user_history| %>
      <div class="card history_card">
        <div class="card-body pb-1">
          <p class="m-0 p-0" style="color:lightgray"><%=user_history.action_date %></p>
          <div class="d-flex justify-content-between mt-2">
            <h6><%=user_history.action_name %></h6>
            <p class="plant_detail_score"> + <%= user_history.action_points %> points </p>
          </div>
        </div>
      </div>
    <% end %>
    <%#please don't remove this br br%>
    <br><br>
  </div>
</div>
